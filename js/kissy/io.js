/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Jun 13 15:28
*/
KISSY.add("io","io/form-serializer,io/base,util,io/xhr-transport,io/script-transport,io/jsonp,io/form,io/iframe-transport,io/methods".split(","),function(l,a,n,k){function f(a,d,e,i,j){if(typeof d==="function"){i=e;e=d;d=void 0}return c({type:j||"get",url:a,data:d,success:e,dataType:i})}var l=a("io/form-serializer"),c=a("io/base"),n=a("util");a("io/xhr-transport");a("io/script-transport");a("io/jsonp");a("io/form");a("io/iframe-transport");a("io/methods");n.mix(c,{serialize:l.serialize,get:f,post:function(a,
c,e,i){if(typeof c==="function"){i=e;e=c;c=void 0}return f(a,c,e,i,"post")},jsonp:function(a,c,e){if(typeof c==="function"){e=c;c=void 0}return f(a,c,e,"jsonp")},getScript:a.load,getJSON:function(a,c,e){if(typeof c==="function"){e=c;c=void 0}return f(a,c,e,"json")},upload:function(a,d,e,i,j){if(typeof e==="function"){j=i;i=e;e=void 0}return c({url:a,type:"post",dataType:j,form:d,data:e,success:i})}});k.exports=c});
KISSY.add("io/form-serializer",["util","dom","querystring"],function(l,a,n,k){function f(a){return a.replace(i,"\r\n")}var c=a("util"),g=a("dom"),d=a("querystring"),e=/^(?:select|textarea)/i,i=/\r?\n/g,j,h=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;j={serialize:function(a,c){return d.stringify(j.getFormData(a),void 0,void 0,c||!1)},getFormData:function(a){var i=[],m={};c.each(g.query(a),function(a){if(a.elements){for(var a=a.elements,b=[],r=
0;r<a.length;r++)b.push(a[r]);a=b}else a=[a];i.push.apply(i,a)});i=c.filter(i,function(a){return a.name&&!a.disabled&&(a.checked||e.test(a.nodeName)||h.test(a.type))});c.each(i,function(a){var b=g.val(a),r;null!==b&&(b=c.isArray(b)?c.map(b,f):f(b),(r=m[a.name])?(r&&!c.isArray(r)&&(r=m[a.name]=[r]),r.push.apply(r,c.makeArray(b))):m[a.name]=b)});return m}};k.exports=j});
KISSY.add("io/base","util,querystring,logger-manager,event/custom,promise,url".split(","),function(l,a,n,k){function f(b){var a=b.context;delete b.context;b=g.mix(g.clone(q),b,{deep:true});b.context=a||b;var c,e=b.type,m=b.dataType,a=b.uri=i.parse(i.resolve(o,b.url),true);a.query={};if(!("crossDomain"in b))b.crossDomain=!(a.protocol===p.protocol&&a.host===p.host);e=b.type=e.toUpperCase();b.hasContent=!h.test(e);if(b.processData&&(c=b.data)&&typeof c!=="string")b.data=d.stringify(c,void 0,void 0,b.serializeArray);
m=b.dataType=g.trim(m||"*").split(j);if(!("cache"in b)&&g.inArray(m[0],["script","jsonp"]))b.cache=false;if(!b.hasContent){b.data&&g.mix(a.query,d.parse(b.data));if(b.cache===false)a.query._ksTS=g.now()+"_"+g.guid()}return b}function c(b){var a=this;if(!(a instanceof c))return new c(b);c.superclass.constructor.call(a);e.Defer(a);a.userConfig=b;b=f(b);g.mix(a,{responseData:null,config:b||{},timeoutTimer:null,responseText:null,responseXML:null,responseHeadersString:"",responseHeaders:null,requestHeaders:{},
readyState:0,state:0,statusText:null,status:0,transport:null});var i;c.fire("start",{ajaxConfig:b,io:a});i=new (m[b.dataType[0]]||m["*"])(a);a.transport=i;b.contentType&&a.setRequestHeader("Content-Type",b.contentType);var q=b.dataType[0],j,p=b.timeout,d=b.context,o=b.headers,h=b.accepts;a.setRequestHeader("Accept",q&&h[q]?h[q]+(q==="*"?"":", */*; q=0.01"):h["*"]);for(j in o)a.setRequestHeader(j,o[j]);if(b.beforeSend&&b.beforeSend.call(d,a,b)===false)return a;a.readyState=1;c.fire("send",{ajaxConfig:b,
io:a});if(b.async&&p>0)a.timeoutTimer=setTimeout(function(){a.abort("timeout")},p*1E3);try{a.state=1;i.send()}catch(k){a.state<2&&a._ioReady(-1,k.message||"send error")}return a}var g=a("util"),d=a("querystring");a("logger-manager");var l=a("event/custom"),e=a("promise"),i=a("url"),j=/\s+/,a=function(a){return a},h=/^(?:GET|HEAD)$/,o=location.href,p=i.parse(o),n=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/.test(p.protocol),m={},q={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",
async:true,serializeArray:true,processData:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},converters:{text:{json:g.parseJson,html:a,text:a,xml:g.parseXML}},headers:{"X-Requested-With":"XMLHttpRequest"},contents:{xml:/xml/,html:/html/,json:/json/}};q.converters.html=q.converters.text;g.mix(c,l.Target);g.mix(c,{isLocal:n,setupConfig:function(a){g.mix(q,a,{deep:true})},setupTransport:function(a,c){m[a]=c},getTransport:function(a){return m[a]},
getConfig:function(){return q}});k.exports=c});
KISSY.add("io/xhr-transport","util,./base,./xhr-transport-base,./xdr-flash-transport,./sub-domain-transport,logger-manager".split(","),function(l,a){function n(a){var h=a.config,o=h.crossDomain,p=h.xdr||{},m=p.subDomain=p.subDomain||{};this.io=a;if(o&&!c.supportCORS){if(e.domain&&k.endsWith(h.uri.hostname,e.domain)&&m.proxy!==false)return new d(a);if(""+p.use==="flash"||!i)return new g(a)}this.nativeXhr=c.nativeXhr(o);return this}var k=a("util"),f=a("./base"),c=a("./xhr-transport-base"),g=a("./xdr-flash-transport"),
d=a("./sub-domain-transport");a("logger-manager");var e=document,i=c.XDomainRequest_;k.augment(n,c.proto,{send:function(){this.sendInternal()}});f.setupTransport("*",n)});
KISSY.add("io/xhr-transport-base","util,url,querystring,./base,ua,logger-manager".split(","),function(l,a,n,k){function f(a,b){try{return new (b||h).XMLHttpRequest}catch(c){}}function c(a){var b;if(a.ifModified){b=a.uri;if(a.cache===false){b=g.clone(b);delete b.query._ksTS}b=d.stringify(b)}return b}var g=a("util"),d=a("url"),e=a("querystring"),i=a("./base"),l=a("ua");a("logger-manager");var j,h=window,o=l.ieMode>7&&h.XDomainRequest,a={proto:{}},p={},m={};i.__lastModifiedCached=p;i.__eTagCached=m;
a.nativeXhr=h.ActiveXObject?function(a,b){var c;if(!j&&a&&o)c=new o;else if(!(c=!i.isLocal&&f(a,b)))a:{try{c=new (b||h).ActiveXObject("Microsoft.XMLHTTP");break a}catch(e){}c=void 0}return c}:f;j=a.supportCORS="withCredentials"in a.nativeXhr();a.XDomainRequest_=o;g.mix(a.proto,{sendInternal:function(){var a=this,b=a.io,i=b.config,d=a.nativeXhr,h=i.files,f=h?"post":i.type,k=i.async,n,l=b.mimeType,t=b.requestHeaders||{},b=b._getUrlForSend(),v=c(i),s,w;if(v){if(s=p[v])t["If-Modified-Since"]=s;if(s=m[v])t["If-None-Match"]=
s}(n=i.username)?d.open(f,b,k,n,i.password):d.open(f,b,k);f=i.xhrFields||{};"withCredentials"in f&&(j||delete f.withCredentials);for(w in f)try{d[w]=f[w]}catch(z){}l&&d.overrideMimeType&&d.overrideMimeType(l);t["X-Requested-With"]===false&&delete t["X-Requested-With"];if(typeof d.setRequestHeader!=="undefined")for(w in t)d.setRequestHeader(w,t[w]);var x=i.hasContent&&i.data||null;if(h){l=x;t={};l&&(t=e.parse(l));t=g.mix(t,h);x=new FormData;g.each(t,function(a,b){g.isArray(a)?g.each(a,function(a){x.append(b+
(i.serializeArray?"[]":""),a)}):x.append(b,a)})}d.send(x);if(!k||d.readyState===4)a._callback();else if(o&&d instanceof o){d.onload=function(){d.readyState=4;d.status=200;a._callback()};d.onerror=function(){d.readyState=4;d.status=500;a._callback()}}else d.onreadystatechange=function(){a._callback()}},abort:function(){this._callback(0,1)},_callback:function(a,b){var e=this.nativeXhr,d=this.io,j,h,f,k,n,l=d.config;try{if(b||e.readyState===4){if(o&&e instanceof o){e.onerror=g.noop;e.onload=g.noop}else e.onreadystatechange=
g.noop;if(b)e.readyState!==4&&e.abort();else{j=c(l);var v=e.status;if(!(o&&e instanceof o))d.responseHeadersString=e.getAllResponseHeaders();if(j){h=e.getResponseHeader("Last-Modified");f=e.getResponseHeader("ETag");h&&(p[j]=h);f&&(m[f]=f)}if((n=e.responseXML)&&n.documentElement)d.responseXML=n;var s=d.responseText=e.responseText;if(l.files&&s){var w,z;if((w=s.indexOf("<body>"))!==-1){z=s.lastIndexOf("</body>");if(z===-1)z=s.length;s=s.slice(w+6,z)}d.responseText=g.unEscapeHtml(s)}try{k=e.statusText}catch(x){k=
""}!v&&i.isLocal&&!l.crossDomain?v=d.responseText?200:404:v===1223&&(v=204);d._ioReady(v,k)}}}catch(A){e.onreadystatechange=g.noop;b||d._ioReady(-1,A.message||"process error")}}});k.exports=a});
KISSY.add("io/xdr-flash-transport",["util","./base","dom","logger-manager"],function(l,a,n,k){function f(a,i,b){p||(p=!0,a='<object id="'+j+'" type="application/x-shockwave-flash" data="'+a+'" width="0" height="0"><param name="movie" value="'+a+'" /><param name="FlashVars" value="yid='+i+"&uid="+b+'&host=KISSY.IO" /><param name="allowScriptAccess" value="always" /></object>',i=o.createElement("div"),e.prepend(i,o.body||o.documentElement),i.innerHTML=a)}function c(a){this.io=a}var g=a("util"),d=a("./base"),
e=a("dom");a("logger-manager");var i={},j="io_swf",h,o=document,p=!1;g.augment(c,{send:function(){var c=this,e=c.io,b=e.config,d=b.xdr||{};d.src||(d.src="undefined"!==typeof KISSY&&KISSY.DEV_MODE?a.toUrl("../../assets/io.swf"):a.toUrl("./assets/io.swf"));f(d.src,1,1);h?(c._uid=g.guid(),i[c._uid]=c,h.send(e._getUrlForSend(),{id:c._uid,uid:c._uid,method:b.type,data:b.hasContent&&b.data||{}})):setTimeout(function(){c.send()},200)},abort:function(){h.abort(this._uid)},_xdrResponse:function(a,c){var b,
e=c.id,d,j=c.c,p=this.io;if(j&&(d=j.responseText))p.responseText=decodeURI(d);switch(a){case "success":b={status:200,statusText:"success"};delete i[e];break;case "abort":delete i[e];break;case "timeout":case "transport error":case "failure":delete i[e],b={status:"status"in j?j.status:500,statusText:j.statusText||a}}b&&p._ioReady(b.status,b.statusText)}});d.applyTo=function(a,c,b){var a=c.split(".").slice(1),e=d;g.each(a,function(a){e=e[a]});e.apply(null,b)};d.xdrReady=function(){h=o.getElementById(j)};
d.xdrResponse=function(a,c){var b=i[c.uid];b&&b._xdrResponse(a,c)};KISSY.IO=d;k.exports=c});
KISSY.add("io/sub-domain-transport","util,event/dom,url,dom,./xhr-transport-base,logger-manager".split(","),function(l,a,n,k){function f(a){var c=a.config;this.io=a;c.crossDomain=false}function c(){var a=h[this.io.config.uri.hostname];a.ready=1;g.detach(a.iframe,"load",c,this);this.send()}var l=a("util"),g=a("event/dom"),d=a("url"),e=a("dom"),i=a("./xhr-transport-base");a("logger-manager");var j=document,h={};l.augment(f,i.proto,{send:function(){var a=this.io.config,p=a.uri,m=p.hostname,f=h[m],b=
"/sub_domain_proxy.html";if(a.xdr&&a.xdr.subDomain&&a.xdr.subDomain.proxy)b=a.xdr.subDomain.proxy;if(f&&f.ready)(this.nativeXhr=i.nativeXhr(0,f.iframe.contentWindow))&&this.sendInternal();else{if(f)a=f.iframe;else{f=h[m]={};a=f.iframe=j.createElement("iframe");e.css(a,{position:"absolute",left:"-9999px",top:"-9999px"});e.prepend(a,j.body||j.documentElement);m={};m.protocol=p.protocol;m.host=p.host;m.pathname=b;a.src=d.stringify(m)}g.on(a,"load",c,this)}}});k.exports=f});
KISSY.add("io/script-transport",["util","./base","logger-manager"],function(l,a){function n(a){if(!a.config.crossDomain)return new (f.getTransport("*"))(a);this.io=a;return this}var k=a("util"),f=a("./base");a("logger-manager");f.setupConfig({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{text:{script:function(a){k.globalEval(a);return a}}}});k.augment(n,{send:function(){var c=this,
f=c.io,d=f.config;c.script=a.load(f._getUrlForSend(),{charset:d.scriptCharset,success:function(){c._callback("success")},error:function(){c._callback("error")}})},_callback:function(a,f){var d=this.io;this.script&&(this.script=void 0,f||("error"!==a?d._ioReady(200,"success"):"error"===a&&d._ioReady(500,"script error")))},abort:function(){this._callback(0,1)}});f.setupTransport("script",n)});
KISSY.add("io/jsonp",["util","./base"],function(l,a){var n=a("util"),k=a("./base"),f=window;k.setupConfig({jsonp:"callback",jsonpCallback:function(){return n.guid("jsonp")}});k.on("start",function(a){var g=a.io,d=g.config,a=d.dataType;if("jsonp"===a[0]){delete d.contentType;var e,i=d.jsonpCallback,j="function"===typeof i?i():i,h=f[j];d.uri.query[d.jsonp]=j;f[j]=function(a){1<arguments.length&&(a=n.makeArray(arguments));e=[a]};g.fin(function(){f[j]=h;if(void 0===h)try{delete f[j]}catch(a){}else e&&
h(e[0])});g=d.converters;g.script=g.script||{};g.script.json=function(){if(!e)throw Error("not call jsonpCallback: "+j);return e[0]};a.length=2;a[0]="script";a[1]="json"}})});
KISSY.add("io/form",["util","./base","dom","querystring","./form-serializer"],function(l,a){var n=a("util"),k=a("./base"),f=a("dom"),c=a("querystring"),g=a("./form-serializer"),d=Array.prototype.slice,e=window.FormData;k.on("start",function(a){var j,h,a=a.io.config;if(h=a.form){j=f.get(h);h=a.data;for(var k=!1,p={},m=f.query("input",j),q=0,b=m.length;q<b;q++){var r=m[q];if("file"===r.type.toLowerCase()){k=!0;if(!e)break;var l=d.call(r.files,0);p[f.attr(r,"name")]=1<l.length?l:l[0]||null}}k&&e&&(a.files=
a.files||{},n.mix(a.files,p),delete a.contentType);!k||e?(j=g.getFormData(j),a.hasContent?(j=c.stringify(j,void 0,void 0,a.serializeArray),a.data=h?a.data+("&"+j):j):n.mix(a.uri.query,j)):(h=a.dataType,a=h[0],"*"===a&&(a="text"),h.length=2,h[0]="iframe",h[1]=a)}})});
KISSY.add("io/iframe-transport","util,querystring,dom,./base,event/dom,logger-manager,ua".split(","),function(l,a){function n(a){var e=c.guid("io-iframe"),i=d.getEmptyIframeSrc(),a=a.iframe=d.create("<iframe "+(i?' src="'+i+'" ':"")+' id="'+e+'" name="'+e+'" style="position:absolute;left:-9999px;top:-9999px;"/>');d.prepend(a,h.body||h.documentElement);return a}function k(a,e,i){var b=[],j,f,g,k;c.each(a,function(a,p){j=c.isArray(a);f=c.makeArray(a);for(g=0;g<f.length;g++){k=h.createElement("input");
k.type="hidden";k.name=p+(j&&i?"[]":"");k.value=f[g];d.append(k,e);b.push(k)}});return b}function f(a){this.io=a}var c=a("util"),g=a("querystring"),d=a("dom"),e=a("./base"),i=a("event/dom");a("logger-manager");var j=a("ua"),h=document,o=c.clone(e.getConfig().converters.text);o.json=function(a){return c.parseJson(c.unEscapeHtml(a))};e.setupConfig({converters:{iframe:o,text:{iframe:function(a){return a}},xml:{iframe:function(a){return a}}}});c.augment(f,{send:function(){function a(){i.on(h,"load error",
e._callback,e);u.submit()}var e=this,c=e.io,b=c.config,f,h,l,o=b.data,u=d.get(b.form);e.attrs={target:d.attr(u,"target")||"",action:d.attr(u,"action")||"",encoding:d.attr(u,"encoding"),enctype:d.attr(u,"enctype"),method:d.attr(u,"method")};e.form=u;h=n(c);d.attr(u,{target:h.id,action:c._getUrlForSend(),method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});o&&(l=g.parse(o));l&&(f=k(l,u,b.serializeArray));e.fields=f;j.ie===6?setTimeout(a,0):a()},_callback:function(a){var e=this,
f=e.form,b=e.io,a=a.type,h,g=b.iframe;if(g){a==="abort"&&j.ie===6?setTimeout(function(){d.attr(f,e.attrs)},0):d.attr(f,e.attrs);d.remove(this.fields);i.detach(g);setTimeout(function(){d.remove(g)},30);b.iframe=null;if(a==="load")try{if((h=g.contentWindow.document)&&h.body){b.responseText=d.html(h.body);if(c.startsWith(b.responseText,"<?xml"))b.responseText=void 0}b.responseXML=h&&h.XMLDocument?h.XMLDocument:h;h?b._ioReady(200,"success"):b._ioReady(500,"parser error")}catch(k){b._ioReady(500,"parser error")}else a===
"error"&&b._ioReady(500,"error")}},abort:function(){this._callback({type:"abort"})}});e.setupTransport("iframe",f)});
KISSY.add("io/methods",["util","promise","./base","logger-manager","url"],function(l,a){function n(a){var c=a.responseText,d=a.responseXML,h=a.config,f=h.converters,g,m,l=h.contents,b=h.dataType;if(c||d){for(h=a.mimeType||a.getResponseHeader("Content-Type");"*"===b[0];)b.shift();if(!b.length)for(g in l)if(l[g].test(h)){b[0]!==g&&b.unshift(g);break}b[0]=b[0]||"text";for(g=0;g<b.length;g++)if("text"===b[g]&&void 0!==c){m=c;break}else if("xml"===b[g]&&void 0!==d){m=d;break}if(!m){var n={text:c,xml:d};
k.each(["text","xml"],function(a){var e=b[0];if(f[a]&&f[a][e]&&n[a])return b.unshift(a),m="text"===a?c:d,!1})}}l=b[0];for(h=1;h<b.length;h++){g=b[h];var y=f[l]&&f[l][g];if(!y)throw Error("no covert for "+l+" => "+g);m=y(m);l=g}a.responseData=m}var k=a("util"),f=a("promise"),c=a("./base");a("logger-manager");var g=a("url"),d=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;k.extend(c,f,{setRequestHeader:function(a,c){this.requestHeaders[a]=c;return this},getAllResponseHeaders:function(){return 2===this.state?this.responseHeadersString:
null},getResponseHeader:function(a){var c,f,a=a.toLowerCase();if(2===this.state){if(!(f=this.responseHeaders))for(f=this.responseHeaders={};c=d.exec(this.responseHeadersString);)f[c[1].toLowerCase()]=c[2];c=f[a]}return void 0===c?null:c},overrideMimeType:function(a){this.state||(this.mimeType=a);return this},abort:function(a){a=a||"abort";this.transport&&this.transport.abort(a);this._ioReady(0,a);return this},getNativeXhr:function(){var a=this.transport;return a?a.nativeXhr:null},_ioReady:function(a,
d){if(2!==this.state){this.state=2;this.readyState=4;var f;if(200<=a&&300>a||304===a)if(304===a)d="not modified",f=!0;else try{n(this),d="success",f=!0}catch(h){d=h.message||"parser error"}else 0>a&&(a=0);this.status=a;this.statusText=d;var g=this.defer,k=this.config,l;if(l=this.timeoutTimer)clearTimeout(l),this.timeoutTimer=0;l=f?"success":"error";var q,b=[this.responseData,d,this],r=k.context,y={ajaxConfig:k,io:this};(q=k[l])&&q.apply(r,b);(q=k.complete)&&q.apply(r,b);c.fire(l,y);c.fire("complete",
y);g[f?"resolve":"reject"](b)}},_getUrlForSend:function(){var a=this.config,c=a.uri,d=c.search||"";delete c.search;d&&!k.isEmptyObject(c.query)&&(d="&"+d.substring(1));return g.stringify(c,a.serializeArray)+d}})});
