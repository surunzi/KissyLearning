/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Jun 13 11:40
*/
KISSY.add("base",["util","attribute"],function(j,o,v,r){function k(b,a){return function(c){return function(){a?c!==i&&c.apply(this,arguments):this.callSuper.apply(this,arguments);var d=arguments.callee.__owner__.__extensions__||[];a&&d.reverse();var e=arguments,g;if(g=d&&d.length)for(var h=0;h<g;h++){var f=d[h]&&(!b?d[h]:d[h].prototype[b]);f&&f.apply(this,e||[])}a?this.callSuper.apply(this,arguments):c!==i&&c.apply(this,arguments)}}}function p(b){var a=this.__hooks__,c=this.prototype;if(this.__extensions__.length&&
a)for(var d in a)if(!c.hasOwnProperty(d)||b.hasOwnProperty(d))b[d]=b[d]||i;return s.call(this,b)}function t(b){var a;b.target===this&&(a=this[l+b.type.slice(5).slice(0,-6)],a.call(this,b.newVal,b))}function u(b){var a=b.get("plugins"),c;f.each(a,function(b,e){"function"===typeof b&&(c=b,a[e]=new c)})}function m(b,a){var c,d,e=this.get("plugins"),a=a||[],a=[this].concat(a);if(c=e.length)for(var g=0;g<c;g++)(d=e[g][b])&&d.apply(e[g],a)}var f=o("util"),q=o("attribute"),n=f.ucfirst,l="_onSet",i=f.noop,
j=q.extend({constructor:function(){this.callSuper.apply(this,arguments);var b=this.get("listeners");if(b)for(var a in b)this.on(a,b[a]);this.initializer();u(this);m.call(this,"pluginInitializer");this.bindInternal();this.syncInternal()},initializer:i,__getHook:k,__callPluginsMethod:m,bindInternal:function(){var b=this.getAttrs(),a,c;for(a in b)if(c=l+n(a),this[c])this.on("after"+n(a)+"Change",t)},syncInternal:function(){var b=[],a;a=this.constructor;for(var c=this.getAttrs();a;)b.push(a),a=a.superclass&&
a.superclass.constructor;b.reverse();for(a=0;a<b.length;a++){var d=b[a].ATTRS||{},e;for(e in d)if(e in c){var g,f;(f=this[l+n(e)])&&0!==c[e].sync&&void 0!==(g=this.get(e))&&f.call(this,g)}}},plug:function(b){"function"===typeof b&&(b=new b);b.pluginInitializer&&b.pluginInitializer(this);this.get("plugins").push(b);return this},unplug:function(b){var a=[],c=this,d="string"===typeof b;f.each(c.get("plugins"),function(e){var f=0,h;b&&(d?(h=e.get&&e.get("pluginId")||e.pluginId,h!==b&&(a.push(e),f=1)):
e!==b&&(a.push(e),f=1));f||e.pluginDestructor(c)});c.setInternal("plugins",a);return c},getPlugin:function(b){var a=null;f.each(this.get("plugins"),function(c){if((c.get&&c.get("pluginId")||c.pluginId)===b)return a=c,!1});return a},destructor:i,destroy:function(){var b=f.makeArray(arguments);this.get("destroyed")||(m.call(this,"pluginDestructor",b),this.destructor.apply(this,b),this.set("destroyed",!0),this.fire("destroy"),this.detach())}});f.mix(j,{__hooks__:{initializer:k(),destructor:k("__destructor",
!0)},ATTRS:{plugins:{valueFn:function(){return[]}},destroyed:{value:!1},listeners:{}},extend:function a(c,d,e){f.isArray(c)||(e=d,d=c,c=[]);d=q.extend.call(this,d,e);d.__extensions__=c;p.call(d,{});if(c.length){var g={},h={};f.each(c.concat(d),function(a){if(a){f.each(a.ATTRS,function(a,c){var d=g[c]=g[c]||{};f.mix(d,a)});var a=a.prototype,c;for(c in a)a.hasOwnProperty(c)&&(h[c]=a[c])}});d.ATTRS=g;h.constructor=d;f.augment(d,h)}d.extend=e&&e.extend||a;d.addMembers=p;return d}});var s=j.addMembers;
r.exports=j});
