/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Jun 13 11:41
*/
KISSY.add("component/container",["util","component/control"],function(f,g,m,i){function j(a){var b=a.component,c=this.get("children"),a=a.index;c.splice(a,0,b);c=this.get("children");b=c[a];b.setInternal("parent",this);this.get("rendered")&&this.renderChild(a);this.fire("afterAddChild",{component:b,index:a})}function k(a){var b=a.component,c=a.destroy,d=this.get("children"),a=a.index;-1!==a&&d.splice(a,1);b.setInternal("parent",null);b.destroy&&b.destroy(c);this.fire("afterRemoveChild",{component:b,
index:a})}var h=g("util"),f=g("component/control"),l=f.Manager;i.exports=f.extend({isContainer:!0,initializer:function(){var a=this.get("prefixCls"),b=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:j,defaultTargetOnly:!0});this.publish("beforeRemoveChild",{defaultFn:k,defaultTargetOnly:!0});b.prefixCls=b.prefixCls||a},decorateDom:function(){var a=this,b=a.getChildrenContainerEl(),c=a.get("defaultChildCfg"),d=c.prefixCls,e=c.xclass,f=[];b.children().each(function(b){var g=a.getComponentConstructorByNode(d,
b)||e&&l.getConstructorByXClass(e);g&&f.push(new g(h.merge(c,{srcNode:b})))});a.set("children",f)},createDom:function(){this.createChildren()},renderUI:function(){this.renderChildren()},renderChildren:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)this.renderChild(a)},createChildren:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)this.createChild(a)},addChild:function(a,b){var c=this.get("children");void 0===b&&(b=c.length);this.fire("beforeAddChild",{component:a,index:b});
return c[b]},renderChild:function(a){var b=this.get("children");this.createChild(a).render();this.fire("afterRenderChild",{component:b[a],index:a})},createChild:function(a){var b,c,d,e;b=this.get("children")[a];e=this.getChildrenContainerEl();d=e[0];c=d.children[a]||null;b.get("rendered")?(e=b.el,e.parentNode!==d&&d.insertBefore(e,c)):(c?b.set("elBefore",c):b.set("render",e),b.create());this.fire("afterCreateChild",{component:b,index:a});return b},addChildren:function(a){var b,c=a.length;for(b=0;b<
c;b++)this.addChild(a[b])},removeChild:function(a,b){void 0===b&&(b=!0);this.fire("beforeRemoveChild",{component:a,index:h.indexOf(a,this.get("children")),destroy:b})},removeChildren:function(a){var b,c=[].concat(this.get("children"));for(b=0;b<c.length;b++)this.removeChild(c[b],!1);!1!==a&&this.$el&&(this.getChildrenContainerEl()[0].innerHTML="");return this},getChildAt:function(a){return this.get("children")[a]||null},getChildrenContainerEl:function(){return this.$el},destructor:function(a){this.removeChildren(a)}},
{ATTRS:{children:{valueFn:function(){return[]},getter:function(a){var b=null,c,d;for(c=0;c<a.length;c++)d=a[c],d.isControl||(b=b||this.get("defaultChildCfg"),h.mix(d,b,!1),a[c]=this.createComponent(d));return a},setter:function(a){var b,c;for(b=0;b<a.length;b++)c=a[b],c.isControl&&c.setInternal("parent",this)}},defaultChildCfg:{valueFn:function(){return{}}}},name:"container"})});
